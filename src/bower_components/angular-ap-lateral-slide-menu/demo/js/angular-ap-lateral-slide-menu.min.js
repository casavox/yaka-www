/*!
 * angular-ap-lateral-slide-menu v0.0.1 ()
 * Copyright 1994-2014 Autre planete
* 
*            .                                     .                                  
* .  *               *   *             .                          .       .       *   
*        .  *                     *   *    .  *      ,:      .        *     .    .    
*                           *                      ,' |     .     *                   
*  *   .        *       .       .       *         /   :                               
*                                              --'   /                .         .     
*     .  *                       *              / />/                                 
*             *                                / <//_\                 .     -o-      
*  *   .         \:/    .       .       *   __/   /                                   
*                 O                         )'-. /             .                .     
*                    .                      ./  :\                                    
*        *   .                .             /.' '                                     
*                                          '/'       .  *           *                 
*               .                         +                    .                      
*       *                     .           '                                .          
*                                       `.                                            
*               *                   .-"-             .                       .        
*                                  (    |                                             
*           .                   . .-'  '.                          *                  
*                              ( (.   )A:                                             
*                          .'    / (_  )                                  -o-         
*                           _. :(.   )AP  `                 .                         
*     *   .            .  (  `-' (  `.   .                                            
*                        .  :  (   .APx)                                              
*                       /_`( "a `a. )"'                                               
*                   (  (/  .  ' )=='       .  *                             *         
*                  (   (    )  .A"   +                                                
*                    (`'AP.( _(   (                                                   
*                 ..-. `AP    ) `  )  +                                               
*               -'   (      +aP:  )                                                   
*             '    _  `    (AP.cx                    *                                
*           _(    (    )b  -`.  ) +                                                   
*           )/    (AP   (AP    )  )                                                   
*           (  (/  .  ' )  ' ) )                                                      
*            .  (  `-' (  `.  .                                                       
*            ( (.   )    )                                                            
*               (    |                                                                
* 
 */
!function(){"use strict";var a=angular.module("ap.lateralSlideMenu",[]);a.constant("menuConfig",{openClass:"lateral-slide-menu-is-open",inTransitionClass:"lateral-slide-menu-in-transition"}),a.service("menuService",["$document",function(a){var b=null;this.open=function(e){b||(a.bind("click",c),a.bind("keydown",d)),b&&b!==e&&(b.isOpen=!1),b=e},this.close=function(e){b===e&&(b=null,a.unbind("click",c),a.unbind("keydown",d))};var c=function(){},d=function(a){27===a.which&&(b.focusToggleElement(),c())}}]),a.controller("MenuController",["$scope","$attrs","$parse","menuConfig","menuService","$timeout","$animate","$window",function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=this,o=a.$new(),p=d.openClass,q=d.inTransitionClass,r=angular.noop,s=b.onToggle?c(b.onToggle):angular.noop,t="";void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend?(t="-webkit-",j="WebkitTransition",k="webkitTransitionEnd transitionend"):(j="transition",k="transitionend"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend?(t="-webkit-",l="WebkitAnimation",m="webkitAnimationEnd animationend"):(l="animation",m="animationend");var u="Duration",v="Delay",w="IterationCount",x=function(a){var b=null;if(!b){var c=0,d=0,e=0,f=0;angular.forEach(a,function(a){if(1==a.nodeType){var b=h.getComputedStyle(a)||{},g=b[j+u];c=Math.max(y(g),c);var i=b[j+v];d=Math.max(y(i),d);{b[l+v]}f=Math.max(y(b[l+v]),f);var k=y(b[l+u]);k>0&&(k*=parseInt(b[l+w],10)||1),e=Math.max(k,e)}}),b={total:0,transitionDelay:d,transitionDuration:c,animationDelay:f,animationDuration:e}}return b},y=function(a){var b=0,c=angular.isString(a)?a.split(/\s*,\s*/):[];return angular.forEach(c,function(a){b=Math.max(parseFloat(a)||0,b)}),b};this.init=function(d){n.$element=d,n.page=angular.element(document.getElementsByClassName("lateral-slide-menu-main-page")),b.isOpen&&(i=c(b.isOpen),r=i.assign,a.$watch(i,function(a){o.isOpen=!!a}))},this.toggle=function(a){return o.isOpen=arguments.length?!!a:!o.isOpen,o.isOpen},this.isOpen=function(){return o.isOpen},o.getToggleElement=function(){return n.toggleElement},o.focusToggleElement=function(){n.toggleElement&&n.toggleElement[0].focus()},o.$watch("isOpen",function(b,c){if(b)n.$element.addClass(p),n.$element.addClass(q),o.focusToggleElement(),e.open(o);else{n.$element.removeClass(p);var d=x(n.page),g=Math.max(d.transitionDuration,d.animationDuration);f(function(){n.$element.removeClass(q)},1e3*g),e.close(o)}r(a,b),angular.isDefined(b)&&b!==c&&s(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){o.isOpen=!1}),a.$on("$destroy",function(){o.$destroy()})}]),a.directive("lateralSlideMenuController",function(){return{controller:"MenuController",restrict:"AE",link:function(a,b,c,d){d.init(b)}}}),a.directive("lateralSlideMenu",function(){return{require:"^lateralSlideMenuController",restrict:"AE",transclude:!0,template:'<nav class="lateral-slide-menu"><div class="lateral-slide-menu-scrollable-container" ng-transclude></div></nav><div class="lateral-slide-menu-overlay" lateral-slide-menu-toggle></div>'}}),a.directive("lateralSlideMenuToggle",function(){return{require:"^lateralSlideMenuController",restrict:"AE",link:function(a,b,c,d){if(d){d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.addClass("lateral-slide-menu-toggle"),b.attr({"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}})}();