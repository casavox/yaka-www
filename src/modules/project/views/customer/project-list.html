<header id="header" data-current-skin='lightblue' ng-include="'/modules/core/views/header.html'"
></header>

<section id="main">

    <aside id="sidebar" data-ng-include="'/modules/core/views/sidebar-left.html'"
           data-ng-class="{ 'toggled': app.sidebarToggle.left }"></aside>

    <section id="content" class="content">
        <div class="container">
            <div ng-show="vm.projectsOnGoing.length <0" class="card">
                <div class="card-header">
                    <h2>VOUS N’AVEZ ENCORE DE PROJETS
                        <small>Comment fonctionne Yaka Club ?</small>
                    </h2>
                </div>
                <div class="card-body card-padding">
                    <ol>
                        <li>Créez votre projet</li>
                        <li>Recevez des offres et discutez avec nos professionnels</li>
                        <li>Sélectionnez celui qui vous convient</li>
                        <li>Clôturez le projet et partagez votre recommandation</li>
                    </ol>
                </div>
                <div class="panel-footer text-right">
                    <button class="btn btn-lg btn-primary" data-ui-sref="new-project">CREER UN PROJET</button>
                </div>
            </div>

            <div ng-show="vm.projectsOnGoing.length >0" class="block-header">
                <h2>PROJET EN COURS</h2>
            </div>
            <div ng-show="vm.projectsOnGoing.length >0" class="card card-hover" ng-repeat="p in vm.projectsOnGoing"
                 ng-click="vm.selectProject(p)">
                <div class="card-header">
                    <div class="media">
                        <div class="pull-left">
                            <div class="proposalIconBackground lv-img v-icon-{{p.mainActivity.code}}-white">
                            </div>
                        </div>
                        <div class="media-body projectTitleBar" title="{{p.title | yakaTranslateTitle}}">
                            <div class="media-heading row">
                                <div class="col-sm-7">{{p.title | yakaTranslateTitle}}</div>
                                <div class="col-sm-5 textAlignRightFullDesktop paddingRightFullDesktop">
                                    <small class="c-gray">
                                        Mit à jour <span am-time-ago="p.updated"></span>
                                    </small>
                                </div>
                            </div>
                            <div class="c-gray">
                                <strong>{{p.address.name}}</strong> - {{p.address.locality}}
                            </div>
                            <div class="c-gray">
                                Début souhaité {{vm.getDesiredPedriod(p)}}
                            </div>
                        </div>
                        <div class="pull-right">
                            <ul class="actions m-t-20">
                                <li class="dropdown" uib-dropdown>
                                    <a href="" uib-dropdown-toggle>
                                        <i class="zmdi zmdi-chevron-right zmdi-hc-fw c-lightblue"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div ng-show="!p.proposals" class="card-body p-l-25 p-b-20">
                    <span>Réponses des Pro en attentes...</span>
                </div>
                <div ng-show="p.status == 'ONGOING_PROPOSITIONS_RECEIVED' && p.proposals.length > 0">
                    <div class="card-body p-l-25">
                        <span>Choisissez un professionnel pour votre projet.</span>
                        <span ng-show="p.proposals.length == 1">
                            <br>Vous avez reçu <b>1 proposition</b>
                        </span>
                        <span ng-show="p.proposals.length > 1">
                            <br>Vous avez reçu <b>{{p.proposals.length}} propositions</b>
                        </span>
                    </div>
                    <div class="card-body p-l-25 p-r-30 p-t-15 p-b-20">
                        <ul ng-show="p.proposals.length > 0" class="wall-attrs clearfix list-inline list-unstyled">
                            <li ng-show="!p.unreadMessages" class="wa-stats">
                                <span><i class="zmdi zmdi-comment-alt-text c-gray zmdi-hc-fw"></i></span>
                            </li>
                            <li ng-show="p.unreadMessages" class="wa-stats">
                                <span><i class="zmdi zmdi-comment-alt-text c-lightblue zmdi-hc-fw"></i></span>
                            </li>
                            <li ng-show="p.proposals.length > 4" class="wa-users m-r-5" ng-click="vm.selectProject(p)">
                                <div class="p-relative"
                                     title="{{p.proposals.length-3}} autre(s) proposition(s)">
                                    <div class="lv-avatar bgm-bluegray pull-left on-avatar">+{{p.proposals.length-3}}
                                    </div>
                                    <!--<div class="yakaEllipsis vertical-middle f-10" style="width: 40px;">
                                        <span>{{p.proposals.length-3}} autre(s)</span>
                                    </div>-->
                                </div>
                            </li>
                            <li class="wa-users m-r-5" data-ng-repeat="proposal in p.proposals | limitTo:4"
                                ng-click="vm.selectProposal(proposal)">
                                <div class="p-relative"
                                     title="{{proposal.professional.user.firstName}} {{proposal.professional.user.lastName}}">
                                    <yaka-avatar class="on-avatar" size="35"
                                                 user="proposal.professional.user"></yaka-avatar>
                                    <i ng-show="proposal.unreadMessages" class="porposalUnreadMessagesIndicator"></i>
                                    <!--<div class="yakaEllipsis vertical-middle f-10" style="width: 40px;">
                                        <span>{{proposal.professional.user.firstName}}
                                            {{proposal.professional.user.lastName}}
                                        </span>
                                    </div>-->
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div ng-show="p.status == 'ONGOING_PROJECT_ONGOING'" class="card-body p-l-25 p-b-20"
                     ng-click="vm.selectProposal(p.proposals[0])">
                    <div class="media">
                        <div class="pull-left">
                            <div class="btn-dpday bgm-bluegray pull-left on-avatar">
                                <div class="p-relative"
                                     title="{{p.proposals[0].professional.user.firstName}} {{p.proposals[0].professional.user.lastName}}">
                                    <yaka-avatar class="on-avatar" size="42"
                                                 user="p.proposals[0].professional.user"></yaka-avatar>
                                    <i ng-show="p.proposals[0].unreadMessages"
                                       class="porposalUnreadMessagesIndicator"></i>
                                </div>
                            </div>
                        </div>
                        <div class="media-body pull-left" title="{{p.title | yakaTranslateTitle}}">
                            <div class="media-heading m-b-5">
                                <div class="c-gray">Votre Pro. pour ce projet</div>
                                <strong>{{p.proposals[0].professional.user.firstName}}
                                    {{p.proposals[0].professional.user.lastName}}</strong>
                            </div>
                            <ul class="pull-left wall-attrs clearfix list-inline list-unstyled">
                                <li class="wa-stats center">
                                    <span class="bgm-white">
                                        <i class="zmdi zmdi-calendar"></i>
                                        <span data-ng-if="p.proposals[0].startDate">{{p.proposals[0].startDate | date:'dd/MM/yy'}}</span>
                                        <span data-ng-if="!p.proposals[0].startDate">- - -</span>
                                    </span>
                                    <span class="active bgm-white c-lightblue">
                                        <i class="zmdi zmdi-shopping-cart"></i>
                                        <span data-ng-if="p.proposals[0].price">{{p.proposals[0].price}} €</span>
                                        <span data-ng-if="!p.proposals[0].price">- - - €</span>
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</section>
