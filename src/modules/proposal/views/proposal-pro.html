<style type="text/css">
    #map_canvas {
        height: 120px;
        margin: 0px;
        margin-left: -15px;
        margin-right: -15px;
    }

    #map_canvas {
        position: relative;
    }

    .angular-google-map-container {
        position: absolute;
        top: 0;
        bottom: 0;
        right: 0;
        left: 0;
    }
</style>


<section class="view">
    <div class="header-menu">
        <ng-include src="'/modules/core/modules/menu/views/menuHamburger.html'"></ng-include>
        <div class="in-line min-w-44 arrow-nav" ui-sref="pro-proposals"
             ng-if="vm.proposal.status == 'START' || vm.proposal.status == 'COMPLETED' || vm.proposal.status == 'DECLINED'">
            <img src="icons/mdpi/arrow-left.png" class="center-middle"/>
        </div>
        <div class="in-line min-w-44 arrow-nav" ui-sref="pro-jobs"
             ng-if="vm.proposal.status == 'COMPLETED' || vm.proposal.status == 'RATE_PRO' ||  vm.proposal.status == 'SELECTED'">
            <img src="icons/mdpi/arrow-left.png" class="center-middle"/>
        </div>
        <div class="title no-line" ng-show="!vm.proDetails">
            {{vm.project.title}}
            <p class="sub-title-proposal"
               ng-if="vm.proposal.status == 'START' || vm.proposal.status == 'COMPLETED' || vm.proposal.status == 'DECLINED'">
                My Quote
            </p>

            <p class="sub-title-proposal"
               ng-if="vm.proposal.status == 'COMPLETED' || vm.proposal.status == 'RATE_PRO' ||  vm.proposal.status == 'SELECTED'">
                My Job
            </p>
        </div>
        <div class="title" ng-show="vm.proDetails">
            Proposal's details
        </div>
        <a ng-click="app.logout()">
            <div class="logout">
                Log Out
            </div>
        </a>
    </div>
    <div class="page-content">
        <div class="content-slide">
            <div class="project-description" ng-show="!vm.pro">
                <div class="row no-margin">
                    <div class="col-xs-12">
                        <div class="description-action-btn" ng-click="vm.edit()"
                             ng-show="!vm.editFlag && vm.proposal.status != 'DECLINED' && vm.proposal.status != 'RATE_PRO' && vm.proposal.status != 'COMPLETED'">
                            MODIFY
                        </div>
                        <div class="description-action-btn"
                             ng-show="!vm.editFlag && vm.proposal.status != 'DECLINED' && vm.proposal.status != 'RATE_PRO' && vm.proposal.status != 'COMPLETED'"
                             ng-click="vm.decline()">
                            DECLINE
                        </div>
                        <div class="description-action-btn color-red" ng-show="vm.editFlag" ng-click="vm.save()">
                            SAVE
                        </div>
                        <div class="description-action-btn" ng-show="vm.editFlag" ng-click="vm.cancel()">
                            CANCEL
                        </div>
                        <div class="description-date" am-time-ago="vm.proposal.updated">
                            Offer made
                        </div>
                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12">
                        <p class="pro-title-post">
                            Post <span am-time-ago="vm.project.updated"></span>
                        </p>
                        <cl-image public-id="{{vm.proposal.professional.avatar.cloudinaryPublicId}}"
                                  class="img-circle pro-icon-medium mt-20 fl-l ml-15" format="png"
                                  ng-if="vm.proposal.professional.avatar.cloudinaryPublicId">
                            <cl-transformation height="70" width="70" crop="fill"/>
                        </cl-image>
                        <div class="img-default-medium mt-20 fl-l ml-15"
                             ng-if="!vm.proposal.professional.avatar.cloudinaryPublicId">
                            {{vm.proposal.professional.user.firstName[0] | uppercase}}
                            {{vm.proposal.professional.user.lastName[0] | uppercase}}
                        </div>
                        <div class="pro-proposal-title">
                            <p ng-class="{'red': vm.project.type == 'EMERGENCY'}">
                                {{vm.project.title}}
                            </p>

                            <p>
                                {{vm.project.user.firstName}} {{vm.project.user.lastName}}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12 ">
                        <div id="map_canvas">
                            <ui-gmap-google-map center="map.center" zoom="map.zoom" options="mapOptions"
                                                dragging="false">
                                <ui-gmap-circle
                                    ng-if="vm.proposalTmp.status != 'SELECTED' && vm.proposalTmp.status != 'RATE_PRO' && vm.proposalTmp.status != 'COMPLETED'"
                                    center="vm.circle.center" stroke="vm.circle.stroke"
                                    fill="vm.circle.fill" radius="vm.circle.radius"
                                    bounds="vm.circle.bounds"
                                    visible="vm.circle.visible" geodesic="true" editable="false"
                                    draggable="false" clickable="true" control="vm.circle.control"
                                    events="vm.circle.events"></ui-gmap-circle>
                                <ui-gmap-marker
                                    ng-if="vm.proposalTmp.status == 'SELECTED' || vm.proposalTmp.status == 'RATE_PRO' || vm.proposalTmp.status == 'COMPLETED'"
                                    idKey='1' coords='vm.marker.coords' visible="vm.marker.visible"></ui-gmap-marker>
                            </ui-gmap-google-map>
                        </div>
                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12 row no-margin" ng-class="{'cursor-pointer': vm.editFlag}"
                         ng-click="vm.editPrice()" role="grid">
                        <div class="col-xs-12 description-sub-title color-blue">
                            My Price
                            <span class="icon-pen-blue" ng-show="vm.editFlag" ng-click="vm.editWhen()"></span>

                            <p class="my-price-proposal">
                                {{vm.proposalTmp.price}} €
                            </p>
                        </div>
                        <div class="col-xs-12 description-sub-text">
                            This is an {{vm.proposalTmp.priceType | lowercase}} price
                        </div>
                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12 row no-margin" ng-class="{'cursor-pointer': vm.editFlag}"
                         ng-click="vm.editDate()" role="grid">
                        <div class="col-xs-12 description-sub-title color-blue">
                            My start date
                            <span class="icon-pen-blue" ng-show="vm.editFlag" ng-click="vm.editWhen()"></span>

                            <p class="start-date-proposal">
                                {{vm.getStartDate()}}
                            </p>
                        </div>
                        <div class="col-xs-12 description-sub-text">
                            When could you start this job
                        </div>
                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12 row no-margin">
                        <div class="col-xs-12 description-sub-title">
                            Where
                        </div>
                        <div class="col-xs-12 description-sub-text">
                            <div ng-switch on="vm.proposal.status">
                                <div ng-switch-when="SELECTED">
                                    {{vm.projectTmp.address.address}}
                                </div>
                                <div ng-switch-when="RATE_PRO">
                                    {{vm.projectTmp.address.address}}
                                </div>
                                <div ng-switch-when="COMPLETED">
                                    {{vm.projectTmp.address.address}}
                                </div>
                                <div ng-switch-default>
                                    {{vm.projectTmp.address.locality}} {{vm.projectTmp.address.postalCode}}
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12 row no-margin">
                        <div class="col-xs-12 description-sub-title">
                            Desired date
                        </div>
                        <div class="col-xs-12 description-sub-text">
                            {{vm.getWhen()}}
                        </div>
                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12 row no-margin">
                        <div class="col-xs-12 description-sub-title">
                            Tags
                        </div>
                        <div class="col-xs-12 description-sub-text">
                            <span class="red" ng-show="vm.projectTmp.type == 'EMERGENCY'">Emergency</span>
                            {{vm.getTags()}}
                        </div>
                    </div>
                </div>
                <div class="row no-margin">
                    <div class="col-xs-12 row no-margin">
                        <div class="col-xs-12 description-sub-title">
                            Description
                        </div>
                        <div class="col-xs-12 description-sub-text">
                            <textarea msd-elastic class="custom-textarea" disabled
                                      ng-model="vm.projectTmp.description"></textarea>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="menu-r top-120">
            <div>
                <div>
                    <div>
                        <p ng-if="vm.proposal.unreadMessages" class="make-menu-unread">
                            unread messages
                        </p>

                        <p class="make-menu-desc">Chat with {{ vm.proposal.project.user.firstName }}
                            {{vm.proposal.project.user.lastName}}</p>
                        <button type="button" class="button btn btn-menu-sel center bckg-blue"
                                ui-sref="pro-inbox({proposalId:vm.proposal.id})">CHAT
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <div class="popUp" ng-show="vm.declineFlag">
        <div class="popUp-container center-middle">
            <div class="popUp-content">
                <span class="boxclose" ng-click="vm.declineFlag = false"></span>
                <h4>Decline</h4>

                <p class="info-popUp">
                    Caution : Do you really want to refuse this offer ?
                </p>

                <p class="info-popUp-comp">
                    Say why :
                </p>

                <div class="row">
                    <div class="col-xs-12">
                        <textarea class="custom-textarea-red w-100p placeholder-xs mb-10"
                                  placeholder="I am sorry but my schedule has changed so I wouldn't be available without more detail I can't give an engagement ..."
                                  ng-model="vm.declineComment"></textarea>
                    </div>
                </div>

            </div>
            <div class="popUp-footer">
                <div ng-click="vm.declineProposal()">
                    DECLINE
                </div>
                <div ng-click="vm.declineFlag = false">
                    CANCEL
                </div>
            </div>
        </div>
    </div>


    <div class="popUp" ng-show="vm.myPriceFlag">
        <div class="popUp-container center-middle">
            <div class="popUp-content">
                <span class="boxclose" ng-click="vm.myPriceFlag = false; vm.error.price.flag = false"></span>
                <h4>My price</h4>

                <p class="info-popUp">
                </p>

                <p class="info-popUp-comp">
                    Send an estimate or final price
                </p>

                <div class="row">
                    <div class="col-xs-10">
                        <input type="number" class="custom-input-number input-number-hide" ng-model="vm.myPrice"
                               decimal-places>
                    </div>
                    <div class="col-xs-2 sym-euro">
                        €
                    </div>
                </div>
                <p class="error center my-price-error" ng-show="vm.error.price.flag">
                    {{vm.error.price.message}}
                </p>

            </div>
            <div class="clearfix mt-50" ng-show="vm.projectTmp.type != 'EMERGENCY'">
                <div class="pro-popUp-choice fl" ng-click="vm.selectPrice('Estimate')">
                    ESTIMATE
                </div>
                <div class="pro-popUp-choice fr" ng-click="vm.selectPrice('Final')">
                    FINAL
                </div>
            </div>
            <div class="clearfix mt-50" ng-show="vm.projectTmp.type == 'EMERGENCY'">
                <div class="pro-popUp-choice fl" ng-click="vm.selectPrice('Hourly rate')">
                    HOURLY
                </div>
                <div class="pro-popUp-choice fr" ng-click="vm.selectPrice('Flat rate')">
                    FLAT
                </div>
            </div>
        </div>
    </div>


    <div class="popUp" ng-show="vm.myDateFlag">
        <div class="popUp-container center-middle" ng-class="{'w-500': vm.project.type == 'EMERGENCY'}">
            <div class="popUp-content">
                <span class="boxclose" ng-click="vm.myDateFlag = false"></span>
                <h4>My start date</h4>

                <div ng-show="vm.project.type == 'EMERGENCY'">
                    <div class="row center no-margin w-500">
                        <div class="col-xs-12 row line-date">


                            <div class="col-xs-3">

                            </div>
                            <div class="col-xs-3 text-center">
                                {{vm.J1.date | date:"EEE"}}
                            </div>
                            <div class="col-xs-3 text-center">
                                {{vm.J2.date | date:"EEE"}}
                            </div>
                            <div class="col-xs-3 text-center">
                                {{vm.J3.date | date:"EEE"}}
                            </div>
                        </div>
                        <div class="col-xs-12 row line-date">
                            <div class="col-xs-3">
                                7h-9h
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J1.c1 = !vm.J1.c1; vm.J1.all = false"
                                     ng-class="vm.J1.c1Disabled" ng-init="vm.J1.c1 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J1.c1 && vm.J1.c1Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J2.c1 = !vm.J2.c1; vm.J2.all = false"
                                     ng-class="vm.J2.c1Disabled" ng-init="vm.J2.c1 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J2.c1 && vm.J2.c1Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J3.c1 = !vm.J3.c1; vm.J3.all = false"
                                     ng-class="vm.J3.c1Disabled" ng-init="vm.J3.c1 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J3.c1 && vm.J3.c1Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>

                        </div>
                        <div class="col-xs-12 row line-date">
                            <div class="col-xs-3">
                                9h-12h
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J1.c2 = !vm.J1.c2; vm.J1.all = false"
                                     ng-class="vm.J1.c2Disabled" ng-init="vm.J1.c2 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J1.c2 && vm.J1.c2Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J2.c2 = !vm.J2.c2; vm.J2.all = false"
                                     ng-class="vm.J2.c2Disabled" ng-init="vm.J2.c2 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J2.c2 && vm.J2.c2Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J3.c3 = !vm.J3.c3; vm.J3.all = false"
                                     ng-class="vm.J3.c2Disabled" ng-init="vm.J3.c3 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J3.c3 && vm.J3.c2Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>

                        </div>
                        <div class="col-xs-12 row line-date">
                            <div class="col-xs-3">
                                12h-14h
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J1.c3 = !vm.J1.c3; vm.J1.all = false"
                                     ng-class="vm.J1.c3Disabled" ng-init="vm.J1.c3 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J1.c3 && vm.J1.c3Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J2.c3 = !vm.J2.c3; vm.J2.all = false"
                                     ng-class="vm.J2.c3Disabled" ng-init="vm.J2.c3 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J2.c3 && vm.J2.c3Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J3.c3 = !vm.J3.c3; vm.J3.all = false"
                                     ng-class="vm.J3.c3Disabled" ng-init="vm.J3.c3 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J3.c3 && vm.J3.c3Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>

                        </div>
                        <div class="col-xs-12 row line-date">
                            <div class="col-xs-3">
                                14h-16h
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J1.c4 = !vm.J1.c4; vm.J1.all = false"
                                     ng-class="vm.J1.c4Disabled" ng-init="vm.J1.c4 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J1.c4 && vm.J1.c4Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J2.c4 = !vm.J2.c4; vm.J2.all = false"
                                     ng-class="vm.J2.c4Disabled" ng-init="vm.J2.c4 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J2.c4 && vm.J2.c4Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J3.c4 = !vm.J3.c4; vm.J3.all = false"
                                     ng-class="vm.J3.c4Disabled" ng-init="vm.J3.c4 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J3.c4 && vm.J3.c4Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 row line-date">
                            <div class="col-xs-3">
                                16h-18h
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J1.c5 = !vm.J1.c5; vm.J1.all = false"
                                     ng-class="vm.J1.c5Disabled" ng-init="vm.J1.c5 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J1.c5 && vm.J1.c5Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J2.c5 = !vm.J2.c5; vm.J2.all = false"
                                     ng-class="vm.J2.c5Disabled" ng-init="vm.J2.c5 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J2.c5 && vm.J2.c5Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J3.c5 = !vm.J3.c5; vm.J3.all = false"
                                     ng-class="vm.J3.c5Disabled" ng-init="vm.J3.c5 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J3.c5 && vm.J3.c5Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 row line-date">
                            <div class="col-xs-3">
                                18h-20h
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J1.c6 = !vm.J1.c6; vm.J1.all = false"
                                     ng-class="vm.J1.c6Disabled" ng-init="vm.J1.c6 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J1.c6 && vm.J1.c6Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J2.c6 = !vm.J2.c6; vm.J2.all = false"
                                     ng-class="vm.J2.c6Disabled" ng-init="vm.J2.c6 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J2.c6 && vm.J2.c6Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J3.c6 = !vm.J3.c6; vm.J3.all = false"
                                     ng-class="vm.J3.c6Disabled" ng-init="vm.J3.c6 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J3.c6 && vm.J3.c6Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 row line-date">
                            <div class="col-xs-3">
                                Après 20h
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J1.c7 = !vm.J1.c7; vm.J1.all = false"
                                     ng-class="vm.J1.c7Disabled" ng-init="vm.J1.c7 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J1.c7 && vm.J1.c7Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J2.c7 = !vm.J2.c7; vm.J2.all = false"
                                     ng-class="vm.J2.c7Disabled" ng-init="vm.J2.c7 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J2.c7 && vm.J2.c7Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>
                            <div class="col-xs-3">
                                <div class="checkbox-style center-middle"
                                     ng-click="vm.unSelectOther(); vm.J3.c7 = !vm.J3.c7; vm.J3.all = false"
                                     ng-class="vm.J3.c7Disabled" ng-init="vm.J3.c7 = false">
                                    <span class="glyphicon glyphicon-ok check"
                                          ng-show="vm.J3.c7 && vm.J3.c7Disabled != 'checkbox-disabled'"></span>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div ng-show="vm.project.type != 'EMERGENCY'">
                    <div style="display:inline-block; min-height:290px;" class="center custom-picker">
                        <uib-datepicker ng-model="vm.dt" min-date="vm.minDate" max-date="vm.maxDate" show-weeks="true"
                                        class="well well-sm custom-date"
                                        custom-class="getDayClass(date, mode)"></uib-datepicker>
                    </div>
                </div>
            </div>
            <div class="popUp-footer">
                <div ng-click="vm.myDateFlag = false">
                    CANCEL
                </div>
                <div ng-click="vm.selectDate()">
                    CONFIRM
                </div>
            </div>
        </div>
    </div>


</section>
